#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Load direnv environment if available
if command -v direnv > /dev/null; then
  eval "$(direnv export bash 2>/dev/null || true)"
fi

echo "ğŸ” Running pre-commit checks..."

# Check workspace health before commit (non-blocking)
echo "ğŸ¥ Running workspace health check..."
if command -v npm > /dev/null; then
  npm run workspace:doctor > /dev/null 2>&1 || {
    echo "âš ï¸  Workspace health issues detected (non-blocking)"
  }
fi

# Check submodules (non-blocking for now due to migration issues)
echo "ğŸ“¦ Validating submodules..."
git submodule status 2>/dev/null | head -5 | while read -r status path commit_info; do
  if [ -d "$path" ]; then
    echo "âœ“ $path exists"
  else
    echo "âš ï¸  $path missing (non-blocking during migration)"
  fi
done

# Linting disabled temporarily due to permission issues
echo "ğŸ”§ Linting disabled temporarily"
echo "âœ… Pre-commit checks completed"